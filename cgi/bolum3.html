<html>

<head>

<meta http-equiv="Content-Type" content="text/html; charset=windows-1254">
<link rel="shortcut icon" href="/grafik/sinanilyas.ico">
<title>[ www.sinanilyas.com ]</title>
<link rel="stylesheet" type="text/css" href="/css/ortak.css">

</head>

<body>

<table cellspacing="0" cellpadding="0" align="center" border="0" width= "99%">
	<tr style="text-align: center;">
		<td style="background: url(/grafik/cerceve-sol-ust.gif); width:29px; height: 29px;"></td>
		<td style="background: url(/grafik/cerceve-ust.gif); height: 29px;"></td>
		<td style="background: url(/grafik/cerceve-sag-ust.gif); width:29px; height: 29px;"></td>
	</tr>
	<tr>
		<td style="background: url(/grafik/cerceve-sol.gif); width: 29px;"></td>
		<td style="padding-left: 10px; padding-right: 10px; padding-top: 30px; padding-bottom: 10px;">
			<p class="sayfabasligi">Bölüm 3</p>

			<!-- Gövde metni baþlangýcý -->

<p></p>

Ortam deðiþkenleri CGI programý çalýþtýrýlýdýðý zaman browser'ýnýzýn (ve web server'ýnýzýn) programa gönderdiði bilgilerdir. Ortam deðiþkenleri <font face="courier new">%ENV</font> isimli Hash deðiþkende saklanýr.

<p>
<table border="1">

<tr><td colspan="2" height="30" valign="middle">
<font face="tahoma" color="maroon" size="2"><b>&nbsp;CGI Ortam Deðiþkenleri</b></font>

</td></tr><tr><td width="140">
<font face="tahoma" size="2">&nbsp;DOCUMENT_ROOT</font>
</td><td width="400">
<font face="tahoma" size="2">&nbsp;Server'ýnýzýn kök dizinini verir.</font>

</td></tr><tr><td>
<font face="tahoma" size="2">&nbsp;HTTP_COOKIE</font>
</td><td>
<font face="tahoma" size="2">&nbsp;Eðer varsa ziyaretçinin &quot;cookie&quot;sini verir.</font>

</td></tr><tr><td>
<font face="tahoma" size="2">&nbsp;HTTP_HOST</font>
</td><td>
<font face="tahoma" size="2">&nbsp;Server'ýnýzýn &quot;hostname&quot;ini verir.</font>

</td></tr><tr><td>
<font face="tahoma" size="2">&nbsp;HTTP_REFERER</font>
</td><td>
<font face="tahoma" size="2">&nbsp;Scriptin çaðrýldýðý sayfanýn adresini verir.</font>

</td></tr><tr><td>
<font face="tahoma" size="2">&nbsp;HTTP_USER_AGENT</font>
</td><td>
<font face="tahoma" size="2">&nbsp;Ziyaretçinin browser'ýnýn tipini verir.</font>

</td></tr><tr><td>
<font face="tahoma" size="2">&nbsp;PATH</font>
</td><td>
<font face="tahoma" size="2">&nbsp;Server'ýnýzýn &quot;system path&quot;ini verir. (Genelde /bin, /usr/sbin vs.)</font>

</td></tr><tr><td>
<font face="tahoma" size="2">&nbsp;QUERY_STRING</font>
</td><td>
<font face="tahoma" size="2">&nbsp;GET metodu ile yollanan bilgiyi verir.</font>

</td></tr><tr><td>
<font face="tahoma" size="2">&nbsp;REMOTE_ADDR</font>
</td><td>
<font face="tahoma" size="2">&nbsp;Ziyaretçinin IP adresini verir.</font>

</td></tr><tr><td>
<font face="tahoma" size="2">&nbsp;REMOTE_HOST</font>
</td><td>
<font face="tahoma" size="2">&nbsp;Ziyaretçinin &quot;hostname&quot;ini verir. (*)</font>

</td></tr><tr><td>
<font face="tahoma" size="2">&nbsp;REMOTE_PORT</font>
</td><td>
<font face="tahoma" size="2">&nbsp;Ziyaretçinin web server'ýnýza baðlandýðý portu verir.</font>

</td></tr><tr><td>
<font face="tahoma" size="2">&nbsp;REMOTE_USER</font>
</td><td>
<font face="tahoma" size="2">&nbsp;Ziyaretçinin kullanýcý adýný verir. (.htaccess korumalý sayfalar için)</font>

</td></tr><tr><td>
<font face="tahoma" size="2">&nbsp;REQUEST_METHOD</font>
</td><td>
<font face="tahoma" size="2">&nbsp;Bilgi gönderme metodunu verir. (GET ya da POST)</font>

</td></tr><tr><td>
<font face="tahoma" size="2">&nbsp;SCRIPT_FILENAME</font>
</td><td>
<font face="tahoma" size="2">&nbsp;Scriptin tam yolunu verir.</font>

</td></tr><tr><td>
<font face="tahoma" size="2">&nbsp;SERVER_ADMIN</font>
</td><td>
<font face="tahoma" size="2">&nbsp;Server'ýnýzýn webadmin'inin e-mail adresini verir.</font>

</td></tr><tr><td>
<font face="tahoma" size="2">&nbsp;SERVER_NAME</font>
</td><td>
<font face="tahoma" size="2">&nbsp;Server'ýnýzýn tam domain adýný verir. (Örn: cc.sau.edu.tr)</font>

</td></tr><tr><td>
<font face="tahoma" size="2">&nbsp;SERVER_PORT</font>
</td><td>
<font face="tahoma" size="2">&nbsp;Server'ýnýzýn dinlemede olduðu portu verir.</font>

</td></tr><tr><td>
<font face="tahoma" size="2">&nbsp;SERVER_SOFTWARE</font>
</td><td>
<font face="tahoma" size="2">&nbsp;Serverdaki web server programýný verir. (Örn: Apache 1.3)</font>
</td></tr>

</table>

<p>
(*) Eðer server'ýnýzda &quot;reverse-name-lookups&quot; yoksa REMOTE_HOST ziyaretçinin IP adresini verir.

<p>
Bazý server'larda bunlardan baþka deðiþkenler de olabiliyor. Daha fazla bilgi için server'ýnýzýn dökümanlarýný inceleyiniz. Farketmiþseniz bazý deðiþkenler server'la ilgili, bazýlarý ise ziyaretçi ile ilgili bilgileri içeriyor. Server'la ilgili olanlarýn programa bildirdiði bilgiler o server'da çalýþan bütün CGI programlarý için ayný olacaktýr. Fakat ziyaretçi ile ilgili bilgiler program her çalýþtýrýldýðýnda farklý olabilir.

<p>
Her CGI çalýþtýrýldýðýnda bütün ortam deðiþkenleri atanmaz. REMOTE_USER deðiþkeni sadece .htaccess dosyasý ile korunan dizin ya da altdizinler için atanýr. Bu durumda REMOTE_USER deðiþkeninin alacaðý deðer .htaccess dosyasýndaki kullanýcý adýdýr.

<p>
<font face="courier new">%ENV</font> deðiþkeni CGI çalýþtýrýldýðýnda otomatik olarak atanýr ve isterseniz tamamýný isterseniz sadece belli deðerleri kullanabilirsiniz. Mesela aþaðýdaki kod ile ziyaretçinin IP adresini yazdýrabilirsiniz.

<p>
<ul>
<font face="courier new">print &quot;IP adresiniz: $ENV{'REMOTE_ADDR'}\n&quot;;</font>
</ul>

<p>
Þimdi bütün ortam deðiþkenlerini yazdýran bir CGI yazalým. Yeni bir dosya oluþturun, &quot;ortam.cgi&quot; adýyla kaydedin ve içine þunlarý yazýn:

<p>
<ul>
<font face="courier new">
#!/usr/bin/perl<br>
<br>
print &quot;Content-type:text/html\n\n&quot;;<br>
print &lt;&lt;HTMLSonu;<br>
&lt;html&gt;&lt;head&gt;&lt;title&gt;Ortam Deðiþkenleri&lt;/title&gt;&lt;/head&gt;<br>
&lt;body&gt;<br>
HTMLSonu<br>
;<br>
<br>
foreach $anahtar (sort(keys %ENV)) {<br>
&nbsp;&nbsp;&nbsp;print &quot;$anahtar = $ENV{$anahtar}&lt;br&gt;\n&quot;;<br>
}<br>
<br>
print &quot;&lt;/body&gt;&lt;/html&gt;&quot;;<br>
</font>
</ul>

<p>
<img src="../grafik/ok-1.gif" width="13" height="15" align="absmiddle"> 
<a href="http://www.sinanilyas.com/cgi-bin/ornek/ortam.cgi" target="ornek">Denemek için týklayýn</a>

<p>
Scripti kaydedin, eriþim yetkilerini 755 olarak ayarlayýn ve browser'ýnýzdan çaðýrýn. Eðer hata mesajý alýrsanýz programý UNIX'te çalýþmayý deneyip hatanýn nerede olduðunu öðrenebileceðinizi hatýrlayýn.

<p>
Bu örnekte <font face="courier new">sort</font> fonksiyonu kullanýlarak <font face="courier new">%ENV</font> deðiþkeninin anahtarlarý alfabetik sýraya koyduk. Perl'ün <font face="courier new">sort</font> fonksiyonu karakter deðerlerini karþýlaþtýrdýðý için sayýlarý düzgün bir þekilde sýraya koyamaz.

<p>
<h3>Basit Bir Sorgu Formu</h3>

<p>
Bir HTML formundan CGI'a bilgi göndermek için iki yol vardýr. GET ve POST. Form bilgisinin server'a nasýl yollandýðýný bu <i>metodlar</i> belirler. GET metodunda formla gönderilen bilgiler URL'in bir parçasý olarak gönderilir ve QUERY_STRING ortam deðiþkenine atanýr. POST metodunda nasýl gönderildiðini bir sonraki bölümde anlatacaðýz.

<p>
QUERY_STRING deðiþkenine birkaç deðiþik yolla atama yapabiliriz. Birinci yöntem aþaðýda görüldüðü gibidir.

<p>
<img src="../grafik/ok-1.gif" width="13" height="15" align="absmiddle"> 
<a href="http://www.sinanilyas.com/cgi-bin/ornek/ortam.cgi?deneme1" target="ornek">http://www.sinanilyas.com/cgi-bin/ornek/ortam.cgi?deneme1</a>
<br>
<img src="../grafik/ok-1.gif" width="13" height="15" align="absmiddle"> 
<a href="http://www.sinanilyas.com/cgi-bin/ornek/ortam.cgi?deneme2" target="ornek">http://www.sinanilyas.com/cgi-bin/ornek/ortam.cgi?deneme2</a>
<br>
<img src="../grafik/ok-1.gif" width="13" height="15" align="absmiddle"> 
<a href="http://www.sinanilyas.com/cgi-bin/ornek/ortam.cgi?deneme3" target="ornek">http://www.sinanilyas.com/cgi-bin/ornek/ortam.cgi?deneme3</a>

<p>
Yukarýdaki linklerin her birine týklayýn. QUERY_STRING deðiþkeninin deðerinin soru iþaretinden sonra gelen yazý olduðunu göreceksiniz. Bu örneklerde QUERY_STRING deðiþkeni &quot;deneme1&quot;,&quot;deneme2&quot; ve &quot;deneme3&quot; deðerlerini alýr.

<p>
Bir baþka yöntem de aþaðýdaki gibi basit bir form hazýrlamaktýr.

<p>
<ul>
<font face="courier new">
&lt;form action=&quot;http://www.sinanilyas.com/cgi-bin/ornek/ortam.cgi&quot; method=&quot;GET&quot;&gt;<br>
Buraya birþeyler yazýn: &lt;input type=&quot;text&quot; name=&quot;ornek_yazi&quot; size=30&gt;&lt;p&gt;<br>
&lt;/form&gt;
</font>
</ul>

<p>
<img src="../grafik/ok-1.gif" width="13" height="15" align="absmiddle"> 
<a href="ornek/get.html" target="ornek">Denemek için týklayýn</a>

<p>
&quot;Gönder&quot; düðmesinin olmadýðýný farketmiþsinizdir sanýrým. GET metodu ile sadece enter'a basarsýnýz ve form gönderilir. (Bu yöntem sadece bir tane girdi alaný olduðu zaman iþe yarar. Birden fazla girdi alanýný göndermek için mutlaka &quot;Gönder&quot; düðmesi koymalýsýnýz.)

<p>
Yukarýdaki kodlarý kullanarak bir HTML dosyasý hazýrlayýn ve &quot;get.html&quot; adýyla kaydedip browser'ýnýzla açýn. Daha sonra form alanýna birþeyler yazýn ve enter'a basýn. QUERY_STRING deðiþkeninin deðeri aþaðýdaki gibi olur.

<p>
<ul>
<font face="courier new">$ENV{'QUERY_STRING'} = ornek_yazi=iste+yazdiginiz+yazi</font>
</ul>

<p>
Eþittir (=) iþaretinin solundaki yazý form alanýnýn adýdýr. Saðýndaki yazý ise formdaki kutucuða yazdýðýnýz yazýdýr. FAKAT farkettiðiniz gibi boþluklarýn yerini artý (+) iþareti almýþ. Hatta çeþitli noktalama iþaretleri ve özel karakterlerin yerine %-kod þeklinde özel kodlar çýkmýþ.

<p>
Buna &quot;URL Kodlama&quot; denir ve ister GET metodu ister POST metodu kullanýlsýn, herhangi bir form ile bilgi gönderildiði zaman meydana gelir.

<p>
Perl scriptiniz bu bilgiyi eski haline getirebilir fakan uzun ve karmaþýk bilgiler yollandýðýnda POST metodunu kullanmak daha iyidir. GET metodu daha çok veritabanýndan bilgi aratma gibi tek alanlý formlar için elveriþlidir.

<p>
GET metodu ile birden fazla alanlý formlarý da gönderebilirsiniz.

<p>
<ul>
<font face="courier new">
&lt;form action=&quot;http://www.sinanilyas.com/cgi-bin/ornek/ortam.cgi&quot; method=&quot;GET&quot;&gt;<br>
&lt;pre&gt;<br>
&nbsp;&nbsp;&nbsp;Adýnýz: &lt;input type=&quot;text&quot; name=&quot;ad&quot; size=30&gt;&lt;p&gt;<br>
Soyadýnýz: &lt;input type=&quot;text&quot; name=&quot;soyad&quot; size=30&gt;&lt;p&gt;<br>
&lt;/pre&gt;<br>
&lt;input type=&quot;submit&quot; value=&quot;Gönder&quot;&gt;<br>
&lt;/form&gt;
</font>
</ul>

<p>
<img src="../grafik/ok-1.gif" width="13" height="15" align="absmiddle"> 
<a href="ornek/get2.html" target="ornek">Denemek için týklayýn</a>

<p>
Bo formla gönderilen bilgiler aþaðýdaki gibi görünür.

<p>
<ul>
<font face="courier new">$ENV{'QUERY_STRING'} = ad=umut+baris&amp;soyad=ruzgar</font>
</ul>

<p>
Deðerler <font face="courier new">&amp;</font> iþareti ile ayrýlmýþtýr. Bu iki deðeri birbirinden ayýrmak için Perl'ün <font face="courier new">split</font> fonksiyonunu kullanacaðýz.

<p>
<ul>
<font face="courier new">
@degerler = split(/\&amp;/,$ENV{'QUERY_STRING'});<br>
foreach $i (@degerler) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;($alanadi, $deger) = split(/=/,$i);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot;$alanadi = $deger\n&quot;;<br>
}
</font>
</ul>

<p>
<font face="courier new">split</font> fonksiyonu bir karakter sýrasýný, belirtilen karakter ya da karakterlerden ayýrarak bir dizi oluþturur. Örneðimizin ilk satýrýnda QUERY_STRING deðiþkeninin deðeri <font face="courier new">&amp;</font> iþaretinden ikiye ayrýlmýþtýr. <font face="courier new">&amp;</font> iþaretinden önce <font face="courier new">\</font> kullanýlmasýnýn nedeni <font face="courier new">&amp;</font> iþaretinin Perl'de özel bir anlamý olmasýdýr. (Perl'de bazý özel karakterleri kullanýrken baþýna <font face="courier new">\</font> iþareti koymamýz gerekebilir). Bu ayýrma iþlemi sonucu <font face="courier new">@degerler</font> dizisine iki deðer atanýr: <font face="courier new">ad=umut+baris</font> ve <font face="courier new">soyad=ruzgar</font>. <font face="courier new">foreach</font> döngüsünde önce <font face="courier new">=</font> iþaretinden alan adý ve alanlara yazýlan yazýlar birbirinden ayrýlarak <font face="courier new">$alanadi</font> ve <font face="courier new">deger</font> deðiþkenlerine atanýr. Sonra da birbirinden ayrýlmýþ olan bu deðerler yazdýrýlýr.

<p>
GET metodu hakkýnda bazý uyarýlar: Bu metod bilgi göndermek için güvenli deðildir. Bu yüzden þifre ve kredi kartý bilgileri gibi gizli bilgileri gönderirken asla bu metodu kullanmayýnýz. Gönderilen bilgi URL'in bir parçasý olarak gönderildiði için server'ýn log dosyalarýnda kaydedilir ve log dosyalarý da server'daki bütün kullanýcýlar tarafýndan okunabilir. Gizli bilgiler bir sonraki bölümde göreceðimiz POST metodu ile güvenli bir biçimde gönderilebilir.

<p><div align="center">

<table border="0">
<tr><td>
<a href="bolum2.html">
Önceki Sayfa
</a>
</td><td>
<a href="index.html">
Konulara Dön
</a>
</td><td>
<a href="bolum4.html">
Sonraki Sayfa
</a>
</td></tr>
</table>
			<!-- Gövde metni sonu -->

			<p></p>
			

			<p style="text-align: center; font-size: 9px; margin-bottom: 0px;">
			&copy;1997-2005, <a href="http://www.sinanilyas.com/hakkimda" onmouseover="window.status='Özgeçmiþ'; return true;">Sinan ÝLYAS</a>
			</p>
		</td>
		<td style="background: url(/grafik/cerceve-sag.gif); width: 29px;"></td>
	</tr>
	<tr>
		<td style="background: url(/grafik/cerceve-sol-alt.gif); width:29px; height: 29px;"></td>
		<td style="background: url(/grafik/cerceve-alt.gif); height: 29px;"></td>
		<td style="background: url(/grafik/cerceve-sag-alt.gif); width:29px; height: 29px;"></td>
	</tr>
</table>

</body>

</html>
