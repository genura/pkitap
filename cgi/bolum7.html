<html>

<head>

<meta http-equiv="Content-Type" content="text/html; charset=windows-1254">
<link rel="shortcut icon" href="/grafik/sinanilyas.ico">
<title>[ www.sinanilyas.com ]</title>
<link rel="stylesheet" type="text/css" href="/css/ortak.css">

</head>

<body>

<table cellspacing="0" cellpadding="0" align="center" border="0" width= "99%">
	<tr style="text-align: center;">
		<td style="background: url(/grafik/cerceve-sol-ust.gif); width:29px; height: 29px;"></td>
		<td style="background: url(/grafik/cerceve-ust.gif); height: 29px;"></td>
		<td style="background: url(/grafik/cerceve-sag-ust.gif); width:29px; height: 29px;"></td>
	</tr>
	<tr>
		<td style="background: url(/grafik/cerceve-sol.gif); width: 29px;"></td>
		<td style="padding-left: 10px; padding-right: 10px; padding-top: 30px; padding-bottom: 10px;">
			<p class="sayfabasligi">Bölüm 7</p>

			<!-- Gövde metni baþlangýcý -->

<p></p>

Bu bölümde bir dosyanýn içerisinde belli bir metni nasýl aratabileceðimizi anlatacaðým. Eðer bütün sitede arama yaptýrmak istiyorsanýz bunu kendiniz yapmanýzý tavsiye etmem. Bunun için <a href="http://glimpse.cs.arizona.edu/" target="glimpse">Glimpse</a> ve <a href="http://sunsite.berkeley.edu/SWISH-E/" target="SWISH">SWISH</a> gibi hazýr site indexleme araçlarýný kullanabilirsiniz. (SWISH'i tavsiye ederim)

<p>
Dosyada arama yaptýrmanýn deðiþik yollarý vardýr. Eðer bir tek dosyada arama yaptýracaksanýz, bir döngü ile dosyadaki bütün kayýtlarý teker teker okutup aradýðýnýz verinin o kayýtta geçip geçmediðini kontrol edebilir, ya da Perl'ün <font face="Courier New">grep()</font> fonksiyonunu kullanarak dosyanýn tamamýný bir seferde tarayabilirsiniz. Birinci yolu geçen bölümde öðrendiðimiz bilgilerle yapabilirsiniz. Bu bölümde ikinci yol olan  <font face="Courier New">grep()</font> fonksiyonunu kullanarak bunu nasýl yapabileceðinizi anlatacaðým.

<p>
<font face="Courier New">grep()</font> fonksiyonunun kullanýmý aþaðýdaki gibidir.

<p>
<ul>
<font face="Courier New">@sonuclar = grep(/$arananmetin/,@liste);</font>
</ul>

<p>
Sanýrým bir örnek verirsek daha iyi anlaþýlýr.

<p>
<ul>
<font face="Courier New">
#!/usr/bin/perl<br>
@liste = ("sinan","koray","baris","orhan");<br>
$arananmetin = "an";<br>
@sonuclar = grep(/$arananmetin/,@liste);<br>
foreach $i (@sonuclar) { print "$i\n"; }
</font>
</ul>

<p>
Bu programýn çýktýsý aþaðýdaki gibi olur.

<p>
<ul>
<font face="Courier New">
sinan<br>
orhan
</font>
</ul>
<p>
Þimdi biraz daha geliþmiþ bir örnek verelim. Aþaðýdaki gibi, öðrencilerin okul numarasý, isim ve yaþ bilgilerinin kaydedildiði &quot;ogrenci.txt&quot; isimli bir veritabaný dosyamýz olsun.

<p>
<ul>
<font face="Courier New">
1|768|Hasan Þahin|15<br>
2|515|Mustafa Öztürk|16<br>
3|663|Ýlhan Yýldýrým|16<br>
4|697|Fikret Yýlmaz|15<br>
5|716|Haluk Çiçek|15<br>
</font>
</ul>

<p>
Þimdi de bu veritabanýnda arama yaptýrmak için bir script yazalým.

<p>
<ul>
<font face="Courier New">
#!/usr/bin/perl<br>
$veridosyasi = &quot;ogrenci.txt&quot;;<br>
read(STDIN, $tampon, $ENV{'CONTENT_LENGTH'});<br>
@ciftler = split(/&amp;/, $tampon);<br>
<br>
foreach $cift (@ciftler) {<br>
&nbsp;&nbsp;&nbsp;($alanadi, $deger) = split(/=/, $cift);<br>
&nbsp;&nbsp;&nbsp;$deger =~ tr/+/ /;<br>
&nbsp;&nbsp;&nbsp;$deger =~ s/%([a-fA-F0-9][a-fA-F0-9])/pack(&quot;C&quot;, hex($1))/eg;<br>
&nbsp;&nbsp;&nbsp;$deger =~ s/~!/ ~!/g;<br>
&nbsp;&nbsp;&nbsp;$FORM{$alanadi} = $deger;<br>
}<br>
<br>
$arananmetin = $FORM{'isim'};<br>
<br>
open(DOSYA,$veridosyasi);<br>
@bilgiler = &lt;DOSYA&gt;;<br>
close(DOSYA);<br>
print &quot;Content-type:text/html\n\n&quot;;<br>
print &quot;&lt;html&gt;&lt;head&gt;&lt;title&gt;Arama Sonuçlarý&lt;/title&gt;&lt;/head&gt;\n&quot;;<br>
print &quot;&lt;body&gt;&lt;h3&gt;Arama Sonuçlarý&lt;/h3&gt;\n&quot;;<br>
<br>
$bulunansayisi = 0;<br>
<br>
@sonuclar = grep(/$arananmetin/,@bilgiler);<br>
<br>
if ($#sonuclar &gt;= 0) {<br>
&nbsp;&nbsp;&nbsp;foreach $i (@sonuclar) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;chomp($i);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;($kayitno,$okulno,$adsoyad,$yas) = split(/\|/,$i);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot;&lt;b&gt;$adsoyad&lt;/b&gt; Okul No: $okulno Yaþ: $yas&lt;br&gt;\n&quot;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$bulunansayisi++;<br>
&nbsp;&nbsp;&nbsp;}<br>
print &quot;&lt;br&gt;&lt;b&gt;$bulunansayisi&lt;/b&gt; kayýt bulundu.&lt;p&gt;\n&quot;;<br>
}<br>
else {<br>
&nbsp;&nbsp;&nbsp;print "Kayýt Bulunamadý.&lt;p&gt;\n";<br>
}<br>
<br>
print "&lt;/body&gt;&lt;/html&gt;\n&quot;;</font>
</ul>

<p>
Bu programý &quot;ogrenci1.cgi&quot; adýyla kaydedin. Þimdi sýra bu scripti çaðýracak formu hazýrlamaya geldi.

<p>
<ul>
<font face="Courier New">
&lt;form action=&quot;http://www.sinanilyas.com/cgi-bin/ornek/ogrenci1.cgi&quot;&gt;<br>
Aradýðýnýz kiþinin ismini girin &lt;input type=&quot;Text&quot; name=&quot;isim&quot;&gt;<br>
&lt;/form&gt;
</font>
</ul>

<p>
<img src="../grafik/ok-1.gif" width="13" height="15" align="absmiddle"> 
<a href="ornek/ogrenci1.html" target="ornek">Denemek için týklayýn</a>

<p>
<b>Not:</b> <font face="Courier New">$#sonuclar</font> <font face="Courier New">@sonuclar</font> dizisinin eleman sayýsýnýn bir eksiðini verir.

<p>
Formumuzdaki kutucuða &quot;Hasan&quot; (týrnak koymadan) yazarsanýz script size "Hasan Þahin" isimli öðrenciye ait bilgileri verir. Fakat, script kayýtlarý alan ayýrýmý yapmadan taradýðý için isim yerine örneðin "15" (týrnaksýz) yazarsak bize 15 yaþýndaki ve okul numarasýnda 15 geçen öðrencilere ait bilgileri verir. Bunu hatayý gidermek için scriptimizi aþaðýdaki þekilde deðiþtirmemiz gerekir.

<p>
<ul>
<font face="Courier">
#!/usr/bin/perl<br>
$veridosyasi = &quot;ogrenci.txt&quot;;<br>
read(STDIN, $tampon, $ENV{'CONTENT_LENGTH'});<br>
@ciftler = split(/&amp;/, $tampon);<br>
<br>
foreach $cift (@ciftler) {<br>
&nbsp;&nbsp;&nbsp;($alanadi, $deger) = split(/=/, $cift);<br>
&nbsp;&nbsp;&nbsp;$deger =~ tr/+/ /;<br>
&nbsp;&nbsp;&nbsp;$deger =~ s/%([a-fA-F0-9][a-fA-F0-9])/pack(&quot;C&quot;, hex($1))/eg;<br>
&nbsp;&nbsp;&nbsp;$deger =~ s/~!/ ~!/g;<br>
&nbsp;&nbsp;&nbsp;$FORM{$alanadi} = $deger;<br>
}<br>
<br>
$arananmetin = $FORM{'isim'};<br>
<br>
open(DOSYA,$veridosyasi);<br>
@bilgiler = &lt;DOSYA&gt;;<br>
close(DOSYA);<br>
print &quot;Content-type:text/html\n\n&quot;;<br>
print &quot;&lt;html&gt;&lt;head&gt;&lt;title&gt;Arama Sonuçlarý&lt;/title&gt;&lt;/head&gt;\n&quot;;<br>
print &quot;&lt;body&gt;&lt;h3&gt;Arama Sonuçlarý&lt;/h3&gt;\n&quot;;<br>
<br>
$bulunansayisi = 0;<br>
<br>
@sonuclar = grep(/$arananmetin/,@bilgiler);<br>
<br>
if ($#sonuclar &gt;= 0) {<br>
&nbsp;&nbsp;&nbsp;foreach $i (@sonuclar) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;chomp($i);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;($kayitno,$okulno,$adsoyad,$yas) = split(/\|/,$i);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($adsoyad =~ $arananmetin) {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print &quot;&lt;b&gt;$adsoyad&lt;/b&gt; Okul No: $okulno Yaþ: $yas&lt;br&gt;\n&quot;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$bulunansayisi++;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} <br>
&nbsp;&nbsp;&nbsp;}<br>
}<br>
<br>
if ($bulunansayisi == 0) {<br>
&nbsp;&nbsp;&nbsp;print &quot;Kayýt Bulunamadý.&lt;p&gt;\n&quot;;<br>
}<br>
else {<br>
&nbsp;&nbsp;&nbsp;print &quot;&lt;br&gt;&lt;b&gt;$bulunansayisi&lt;/b&gt; kayýt bulundu.&lt;p&gt;\n";<br>
}<br>
<br>
print "&lt;/body&gt;&lt;/html&gt;\n&quot;;
</font>
</ul>

<p>
<img src="../grafik/ok-1.gif" width="13" height="15" align="absmiddle"> 
<a href="ornek/ogrenci2.html" target="ornek">Denemek için týklayýn</a>

<p>
<b>Not:</b> <font face="Courier New">if ($adsoyad =~ $arananmetin)</font> satýrý <font face="Courier New">$arananmetin</font> deðiþkenine atanan metnin, <font face="Courier New">$adsoyad</font> deðiþkenine atanan metnin içerisinde geçip geçmediðini bulmak için kullanýlmýþtýr.

<p>
Bu örnekte <font face="Courier New">$bulunansayisi</font> isimli deðiþkenin deðeri sadece aranan metin &quot;isim&quot; alanýnda bulunduðu zaman arttýrýlýr. Eðer aranan metin &quot;isim&quot; alanýnda deðil de örneðin &quot;yaþ&quot; alanýnda bulunursa kayýt ekrana yazdýrýlmaz ve <font face="Courier New">$bulunansayisi</font> deðiþkeninin deðeri arttýrýlmaz. Scriptin sonunda <font face="Courier New">$bulunansayisi</font> deðiþkeninin deðeri kontrol edilir ve eðer <font face="Courier New">0</font>'sa &quot;Kayýt bulunamadý&quot; mesajý yazdýrýlýr.

<p>
<div align="center">
<table border="0">
<tr><td>
<a href="bolum6.html">
Önceki Sayfa
</a>
</td><td>
<a href="index.html">
Konulara Dön
</a>
</td><td>
<a href="bolum8.html">
Sonraki Sayfa
</a>
</td></tr>
</table>
			<!-- Gövde metni sonu -->

			<p></p>
			

			<p style="text-align: center; font-size: 9px; margin-bottom: 0px;">
			&copy;1997-2005, <a href="http://www.sinanilyas.com/hakkimda" onmouseover="window.status='Özgeçmiþ'; return true;">Sinan ÝLYAS</a>
			</p>
		</td>
		<td style="background: url(/grafik/cerceve-sag.gif); width: 29px;"></td>
	</tr>
	<tr>
		<td style="background: url(/grafik/cerceve-sol-alt.gif); width:29px; height: 29px;"></td>
		<td style="background: url(/grafik/cerceve-alt.gif); height: 29px;"></td>
		<td style="background: url(/grafik/cerceve-sag-alt.gif); width:29px; height: 29px;"></td>
	</tr>
</table>

</body>

</html>
